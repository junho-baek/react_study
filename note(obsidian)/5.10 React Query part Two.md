리액트쿼리는 캐싱을 통해 데이터를 캐싱해서 데이터를 가져오는 시간을 줄여준다.

devtools를 사용하면 쿼리의 상태를 확인할 수 있다.

사용법은 다음과 같다.

```tsx
//App.tsx
import { ReactQueryDevtools } from "@tanstack/react-query-devtools";

<ReactQueryDevtools initialIsOpen={true} position="bottom-right" />;
```

```tsx
//api.ts
const BASE_URL = `https://api.coinpaprika.com/v1`;

export function fetchCoins() {
  return fetch(`${BASE_URL}/coins`).then((response) => response.json());
}

export function fetchCoinInfo(coinId: string) {
  return fetch(`${BASE_URL}/coins/${coinId}`).then((response) =>
    response.json()
  );
}

export function fetchCoinTickers(coinId: string) {
  return fetch(`${BASE_URL}/tickers/${coinId}`).then((response) =>
    response.json()
  );
}

//Coin.tsx

const { isLoading: infoLoading, data: infoData } = useQuery<InfoData>({
  queryKey: ["info", coinId], //쿼리키는 여러개 일 수 있다. 이 키를 바탕으로 데이터의 신선도를 판단한다. api 로 패치된 데이터의 신선도를 측정하기 위해 데이터의 이름을 지어주는 느낌이다.
  queryFn: () => fetchCoinInfo(coinId as string),
});
const { isLoading: tickersLoading, data: tickersData } = useQuery<PriceData>({
  queryKey: ["tickers", coinId],
  queryFn: () => fetchCoinTickers(coinId as string),
});
```

데이터의 신선도
TanStack Query는 캐시한 데이터를 신선(Fresh)하거나 상한(Stale) 상태로 구분해 관리합니다.
캐시된 데이터가 신선하다면 캐시된 데이터를 사용하고, 만약 데이터가 상했다면 서버에 다시 요청해 신선한(새로운) 데이터를 가져옵니다.
일종의 데이터 유통기한 정도로 생각하면 이해하기 쉽습니다.

신선한 데이터와 상한 데이터를 사과에 비유
신선한 데이터와 상한 데이터를 사과에 비유

데이터가 상하는 데까지 걸리는 시간은 staleTime 옵션으로 지정할 수 있습니다.
그리고 신선한지 상했는지 여부는 isStale로 확인할 수 있습니다.

TSX
import { useQuery } from '@tanstack/react-query'

export default function DelayedData() {
const { data, isStale } = useQuery({
queryKey: ['delay'],
queryFn: async () => (await fetch('https://api.heropy.dev/v0/delay?t=1000')).json(),
staleTime: 1000 \* 10 // 10초 후 상함. 즉, 10초 동안 신선함.
})
return (
<>

<div>데이터가 {isStale ? '상했어요..' : '신선해요!'}</div>
<div>{JSON.stringify(data)}</div>
</>
)
}
화면에서 10초 후를 확인해 보세요!
